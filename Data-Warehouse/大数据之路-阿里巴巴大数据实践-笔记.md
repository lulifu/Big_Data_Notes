# 大数据之路：阿里巴巴大数据实践

## 第一篇 数据技术篇

### 第四章 离线数据开发

SQLSCAN 主要有如下三类规则校验:

1. 代码规范类规则，如表命名规范、生命周期设置、表注释等。
2. 代码质量类规则，如调度参数使用检查、分母为 0 提醒、 NULL值参与计算影响结果提醒、插入字段顺序错误等。
3. 代码性能类规则，如分区裁剪失效、扫描大表提醒、重复计算检测等。

SQLSCAN 规则有强规则和弱规则两类。触发强规则后，任务的提交会被阻断，必须修复代码后才能再次提交; 而触发弱规则，则只会显示违反规则的提示，用户可以继续提交任务。

DQC 数据监控规则有强规则和弱规则之分，强规则会阻断任务的执行(将任务置为失败状态，其下游任务将不会被执行);而弱规则只告警而不会阻断任务的执行。

常见的 DQC 监控规则有:主键监控、表数据量及波动监控、重要字段的非空监控、重要枚举宇段的离散值监控、指标值波动监控、业务规则监控等。

在彼岸主要包含如下组件，除满足数据测试的数据对比组件之外，还有数据分布和数据脱敏组件。

1. 数据对比: 支持不同集群、异构数据库的表做数据对比。表级对比规则主要包括数据量和全文对比;字段级对比规则主要包括字段的统计值(如 SUM、 AVG、 MAX、 MIN 等)、枚举值、空值、去重数、长度值等。
2. 数据分布: 提取表和字段的一些特征值，并将这些特征值与预期值进行比对。表级数据特征提取主要包括数据量、主键等;字段级数据特征提取主要包括字段枚举值分布、空值分布、统计值(如SUM、 AVG、 MAX、 MIN 等)、去重数、长度值等。
3. 数据脱敏: 将敏感数据模糊化。在数据安全的大前提下，实现线上数据脱敏，在保证数据安全的同时又保持数据形态的分布，以便业务联调、数据调研和数据交换。

<img width="834" alt="image" src="https://github.com/user-attachments/assets/af8c7c98-e94b-487f-b012-5f1d107cd8cc" />


## 第二篇 数据模型篇

### 第八章 大数据领域建模综述

有了适合业务和基础数据存储环境的模型，那么大数据就能获得以下好处。

1. 性能:良好的数据模型能帮助我们快速查询所需要的数据，减少数据的 IO 吞吐。
2. 成本: 良好的数据模型能极大地减少不必要的数据冗余，也能实现计算结果复用，极大地降低大数据系统中的存储和计算成本。
3. 效率:良好的数据模型能极大地改善用户使用数据的体验，提高使用数据的效率。
4. 质量: 良好的数据模型能改善数据统计口径的不一致性，减少数据计算错误的可能性。

典型的数据仓库建模万法论：

1. ER模型
2. 维度模型
3. DataVault模型
4. Anchor模型

数据仓库设计三范式

第一范式（1NF）

定义：一个关系（表）满足第一范式需要满足以下条件：

原子性：表中的每个字段都必须是不可再分的原子值。也就是说，表中的每个列都应该只包含单一值，而不是集合、数组或其他复杂结构。

目的：确保数据的基本结构化，消除重复的组和多值属性。

示例：假设有一个表 Orders，其中有一列 Items，包含多个商品的列表。如果 Items 列包含多个商品（如 "item1, item2, item3"），则不满足 1NF。为了满足 1NF，需要将每个商品分成单独的行。

第二范式（2NF）

定义：一个关系（表）满足第二范式需要满足以下条件：

满足第一范式（1NF）：首先，表必须满足第一范式的要求。

消除部分函数依赖：所有非主属性必须完全依赖于主键，而不是仅依赖于主键的一部分（在复合主键的情况下）。

目的：消除部分依赖，减少数据冗余。

示例：假设有一个表 StudentCourses，包含 StudentID、CourseID 和 CourseName。如果 CourseName 仅依赖于 CourseID 而不是整个复合主键 (StudentID, CourseID)，则不满足 2NF。为了满足 2NF，需要将 CourseID 和 CourseName 分离到一个单独的表中，比如 Courses，这样 StudentCourses 表中就只包含 StudentID 和 CourseID。

第三范式（3NF）的定义：

一个关系（表）满足第三范式需要满足以下条件：

满足第二范式（2NF）：首先，表必须满足第二范式的要求，即消除部分函数依赖。也就是说，所有非主属性必须完全依赖于主键。

消除传递函数依赖：在满足 2NF 的基础上，3NF 要求消除传递函数依赖。也就是说，非主属性不能依赖于其他非主属性。换句话说，如果 A → B 且 B → C，那么必须消除 A → C 的传递依赖。

3NF 的目的：

1. 减少数据冗余：通过消除传递依赖，3NF 减少了数据冗余，从而减少了数据不一致的风险。
2. 提高数据完整性：通过确保每个非主属性直接依赖于主键，3NF 提高了数据的完整性和一致性。

示例：
假设有一个表 Students，包含以下字段：StudentID（主键）、StudentName、CourseID、CourseName。

如果 CourseName 依赖于 CourseID，而 CourseID 又依赖于 StudentID，那么 CourseName 对 StudentID 存在传递依赖。为了达到 3NF，我们需要将 CourseID 和 CourseName 分离到一个单独的表中，比如 Courses，这样 Students 表中就只包含 StudentID 和 StudentName，而 Courses 表中包含 CourseID 和 CourseName。

通过遵循这些范式，数据库设计可以更好地组织数据，减少冗余，提高数据的完整性和一致性。

### 第九章 阿里巴巴数据整合及管理体系

<img width="808" alt="image" src="https://github.com/user-attachments/assets/0365ed96-4312-43fd-9ddc-8ec3cdde3b5f" />

指导理论：阿里巴巴集团数据公共层设计理念遵循维度建模思想，可参考 Star Schema - The Complete Reference 和 The Data Warehouse Toolkit - The Definitive Guide to Dimensional Modeling。数据模型的维度设计主要以维度建模理论为基础，基于维度数据模型总线架构，构建一致性的维度和事实。

Kimball 维度建模主要探讨需求分析、高层模型、详细模型和模型审查整个过程。
构建维度模型一般要经历三个阶段:第一个阶段是高层设计时期，定义业务过程维度模型的范围，提供每种星形模式的技术和功能描述; 第二个阶段是详细模型设计时期，对每个星形模型添加属性和度量信息;第三个阶段是进行模型的审查、再设计和验证等工作，第四个阶段是产生详细设计文档，提交 ETL 设计和开发。

模型层次：明细数据层和汇总数 据层，采用维度模型方法作为理论基础 ， 更多 地采用 一 些维度退化手法， 将维度退化至事实表中，减少事实表和维表的关联 ，提高明细数据表的 易用性 :同时在汇总数据层， 加强指标的维度退化， 采取更多的宽表 化 手段构建公共 指标数据层，提升公共指标的复用性，减少重复加工。

基本原则：

1. 高内聚和低辑合
2. 核心模型与扩展模型分离
3. 公共处理逻辑下沉及单一
4. 成本与性能平衡
5. 数据可回滚
6. 一致性
7. 命名清晰、可理解

<img width="790" alt="image" src="https://github.com/user-attachments/assets/115cd18c-a144-4627-bbae-6ebef5481704" />



## 第三篇 数据质量篇

## 第四篇 数据应用篇

